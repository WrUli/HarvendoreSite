{% extends 'base.html.twig' %}

{% block title %} Harvendore blog : {{article.title}} {% endblock %}

{% block body %}

    
    <a href="{{ path('app_blog') }}" class="article_link">
        <p>Revenir à tous les articles</p>
    </a>

    <article class="article_container">
        <p class="blog_article_content_title"> {{ article.title }} </p>
        <p> {{article.createDate|date('d-m-Y')}} </p>
        <div class="blog_article_img">
            <div class="blog_article_img_border"></div>
            {% if article.img %}
                <img class="blog_img" src="{{ asset('uploadDirectory/' ~ article.img) }}" alt="{{ article.title }}" >
            {% else %}
                <img class="blog_img" src="{{ asset('assets/img/questionmarkcake.jpg')}}" alt="Image générique" >
            {% endif %}
        </div>
        
        <p> {{article.articleText}} </p>
        <p>dddddddddddd</p>
        
        <p>{{ article.likes }} Likes, {{ article.dislikes }} Dislikes</p>
    </article>

    {% if app.user %}
        <form action="{{path('app_article_vote')}}" method="POST">
            <input type="hidden" value="like" name="value">
            <input type="hidden" value="{{article.id}}" name="idArticle">
            <input type="submit" value="like">
        </form>
        <form action="{{path('app_article_vote')}}" method="POST">
            <input type="hidden" value="dislike" name="value">
            <input type="hidden" value="{{article.id}}" name="idArticle">
            <input type="submit" value="dislike">
        </form>
    {% endif %}

    {% if comments is not empty %}
        {% for comment in comments %}
            <div class="comment">
                <p>{{ comment.commentText }}</p>
                <p>Posté par {{ comment.user.name }} le {{ comment.createDate|date('d-m-Y')}} à {{ comment.createDate|date('H:i') }}</p>
            </div>
            {% if comment.user == app.user %}
                {# <a href="{{ path('app_comment_edit', {'id': comment.id}) }}">Modifier</a> #}
                <a href="{{ path('app_comment_delete', {'id': comment.id}) }}">Supprimer</a>
            {% endif %}
            {% if is_granted('ROLE_ADMIN') %}
                <a href="{{ path('app_comment_moderation_admin', {'id': comment.id}) }}">Modérer</a>
            {% endif %}
        {% endfor %}
    {% else %}
        <p>Pas encore de commentaires pour cet article.</p>
    {% endif %}

    {% if app.user %}
        {{ form_start(commentForm) }}
        {{ form_widget(commentForm) }}
        <button type="submit">Ajouter un commentaire</button>
        {{ form_end(commentForm) }}
    {% else %}
        <p>Connectez-vous pour pouvoir ajouter un commentaire</p>
    {% endif %}
{% endblock %}